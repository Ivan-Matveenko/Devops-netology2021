5.3. Контейнеризация на примере Docker" 

--1. Высоконагруженное монолитное java веб-приложение;
 - физический сервер, т.к. монолитное, селдовательно в микросерверах не реализуемо без изменения кода,
   и так как высоконагруженное -  то необходим физический доступ к ресурсами, без использования гипервизора виртуалки. 

Go-микросервис для генерации отчетов;
 - докер, класический вариант использования контейнеров 
 
Nodejs веб-приложение;
 - это веб приложение, для таких приложений достаточно докера, противопоказаний для контейнерной реализации не вижу.
   и в рамках микропроцессрной архитектуры может быть хорошим решением. 
 
Мобильное приложение c версиями для Android и iOS;
 - Виртаулка -  приложение в докере не имеет GUI, а это по описанию не вариант. 

База данных postgresql используемая, как кэш;
  - в идеале для БД использовать Виртуалку, если доступ к кешу нужен для разных систем, пользователей, 
    использование БД на докере не рекомендуется.
    а так же должен быть сохранен между сессиями , при остановке  приклада.
    вариант с Контейнером(докер) можно рассмотреть только если данные нужны только в рамках сессии 
    самого приложения работающего на этом же контейнере.
    

Шина данных на базе Apache Kafka;
 - зависит от передаваемых данных или контура (тест/прод), для прода и критичности данных лучше Вируалка, для теста достаточно Контейнерной реализации, 
   если потеря данных при потере контенйера не является критичной то можно и в контейнере. 

Очередь для Logstash на базе Redis;
 - физическая машина, так как требуется высокая производительность, т.к. в описании системы в задачах именно производительность заявлена.
   в теории можно и на Аппаратной виртуализации реализовать, зависит от нагрузки, задач и имеющейся инфораструктуры. 
  
Elastic stack для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;
 - сам Elasticsearvh лучше на виртуалку, отказоустойчивость решается на уровне кластера, 
   кибану и логсташ можно вынести в докер контейнер, или так же на виртуалках.
   существуют решения и в таком и в таком исполнении - в интернете есть описания (ссылки не стал кприкладывать :) )
   использование в Докерем может дать "+" для использования в тестовом периоде с максимальным функционалом, 
   в докере можно перезаливать машину каждый месяц и получать опять полную функциональность

Мониторинг-стек на базе prometheus и grafana;
 - сами системы не хранят как таковых данны, можно развернуть на Докере,
   минусов не вижу, в + скорость развертывания, возможность масштабирования для различных задачь: 
     например у графаны есть ограничение на число обрабатываемых метрик и может понадобиться разделения под разные задачи (контуры)

Mongodb, как основное хранилище данных для java-приложения;
 - можно использовать Виртуальную машину, т.к. хранилище и  не сказано что высоконагруженное
   в Контейнере хранить БД с данными не подходит
   для физического сервера может быть через чур расточительно

Jenkins-сервер.
 - так же класический кейс для контейнерной реализации Докер, данных сам не хранит. 


-- 2. docker pull ivanfalaut12/getting-started - ссылка на реп

-- 3. 22:07:05 ivan@upc(0):~$ docker exec -it elastic_bartik /bin/bash
[root@de5978dea65b /]# touch /share/info/myfile
[root@de5978dea65b /]# echo 1_centos>/share/info/myfile
[root@de5978dea65b /]# exit
exit

Листинг из терминала для хостовой машины
22:09:17 ivan@upc(0):~$ cd info
22:09:20 ivan@upc(0):~/info$ dir
myfile
22:09:26 ivan@upc(0):~/info$ cat myfile
1_centos
22:09:47 ivan@upc(0):~/info$ echo my_host_content>hostfile
22:10:39 ivan@upc(0):~/info$ dir
hostfile  myfile
22:10:58 ivan@upc(0):~/info$ 


Листинг из терминаля для  работы с контенерами :
22:09:59 ivan@upc(0):~$ docker exec -it wonderful_taussig /bin/bash
root@69c46eacb43c:/# cd /info
root@69c46eacb43c:/info# dir
hostfile  myfile
root@69c46eacb43c:/info# cat myfile
1_centos
root@69c46eacb43c:/info# cat hostfile
my_host_content
root@69c46eacb43c:/info# 










































1- Выберете подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований
Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий
Требуется наиболее производительное бесплатное opensource решение для виртуализации небольшой (20 серверов) инфраструктуры Linux и Windows виртуальных машин
Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры
Необходимо рабочее окружение для тестирование программного продукта на нескольких дистрибутивах Linux
Ответ:
ТЗ достаточно размытое, нет иформации о то что имеетс я в инфраструктуре, предпочтение в организации. 
    
    
    
    1. скорее MS Hyper-V - так как он более совместим с инфораструктурой на MS,
       меньше затрат на обучение персонала (имяя инфраструктуру на MS кадры уже имеются). 
       имет широкий функционал. 
       Скорее всего используется AD соответвено совместимость Hyper-V будет приоритетнее. 
       Но так же может быть использована и VMVare, все зависит от компетенций персонала, и имеющейся инфраструктры.
       
    2. приоритетнее KVM - гостевые ос могут быть любыми, бесплатен и вполне производителен
       так же может подойти  XEN, но он менее производителен .
    
    3. В данном случае Можно использовать бесплатный Hyper-V, с Windows  будет максимально совместим. в бесплатном исполнее впролне работоспособен.
       
    4. для тетирования достаточно опенсорс KVM или XEN, вполне разумно. 
       если развертывание требуется на не длительном времени, то можно рассмотреть облачные системы AWS/Openstack,
       так как не требуют поддержания своей инфраструктуры, если на тесте "не взлетит", 
       то затраты могут быть ниже нежели при развертывании собственной инраструктуры
    
Опишите сценарий миграции с VMware vSphere на Hyper-V для Linux и Windows виртуальных машин. Детально опишите необходимые шаги для использования всех преимуществ Hyper-V для Windows.

Ответ:
    на счет сценария сложно сказать, но как минимум:
    - завершить работу машины, провести ее преобразование с помощью мастера или конвертера (в интеренет есть решения в том числе от MS)
    - завести машину в Hyper-V
    нашел такую инфу в интернете : https://docs.microsoft.com/ru-ru/system-center/vmm/vm-convert-vmware?view=sc-vmm-2019
    в лекции про этот момент не было раскрыто.
    в целом это достаточно сложная задача и зависит от использованных ОС на виртуалках,
    может потребоваться удаление драйверов и установка новых (или пересборка этой части на *никс)


Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был бы выбор, то создавали ли вы бы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

Ответ:
    Проблемы гетерогенной среды:
       - содержать несколко команд администрирования/сопровождения для разных систем (кдровые издержки)
       - горазду ниже масштабируемость, придется масштабировать 2(или более) системы, 
       - сложность при выделении и управлении ресурсами
       - финансовые затраты, так как необходимо содержать несколько систем одновременно (если считать платные версии)
       - проблемы миграции между разными системами, + полное дублирование всей инфраструктуры под 2(или более) системы виртуализации
       - если бой и тест в разных системах, то отлавливать "баги" сложнее
      
    Без опыта, крайне сложно сказать как минимизировать , но можно предположить:
       - распределить системы по совместимости, например, Hyper-V для всей Windows инфраструктуры и VMWare для остальных. 
       - обучить команду сопровождения работе с обоими системами, для взаимозаменяемости (достаточно спорный вариант, но применяемый)
       - ... дальше затрудняюсь без практического опыта, что-то сказать (нескольких лекций явно недостаточно)
    Предположу что выбрал бы одну систему, так как инфраструктурно и кадрово содержать такую куда практичнее, 
    но есть нюансы в используемых задачах, возможно чисто техниески может потребоваться и разные системы. 
    Без комплектсного видения очень сложно сказать.
    Но при развернтой инраструктуре на Windows, использование других продуктов, и серверов на Windows, 
    то логичнее использовать Hyper-V для подобного решения, и не плодить зоопарка систем. 
    Так же Hyper-V имеет в том числе практически полноценное бесплатное решение.